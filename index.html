<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <title>YouTube Kh√¥ng Qu·∫£ng C√°o ‚Äì Kh√¥ng Rip N·ªØa 2025</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {margin:0;background:#000;color:#fff;font-family:system-ui;padding:15px;}
    input {width:100%;padding:18px;font-size:18px;border:none;border-radius:12px;background:#222;color:#fff;margin:15px 0;}
    #info {background:#111;padding:20px;border-radius:12px;}
    video {width:100%;border-radius:12px;background:#000;}
    img {width:100%;border-radius:12px;margin-top:15px;}
    h1 {text-align:center;color:#ff6b6b;}
    #loading {text-align:center;color:#aaa;}
    .fallback {color:#4a90e2;text-align:center;}
  </style>
</head>
<body>
  <h1>YouTube Kh√¥ng Qu·∫£ng C√°o (Proxy Edition)</h1>
  <input type="text" id="url" placeholder="D√°n link YouTube r·ªìi Enter..." autofocus>
  <div id="info"><div id="loading">D√°n link l√† xem ngay, c√≥ ti·∫øng lu√¥n! (CORS proxy b·ªÅn 2025)</div></div>
  <video id="video" controls autoplay playsinline></video>

  <script>
    const input = document.getElementById("url");
    const info = document.getElementById("info");
    const video = document.getElementById("video");

    input.addEventListener("change", async () => {
      let url = input.value.trim();
      if (!url) return;

      const match = url.match(/(?:v=|\/embed\/|\/shorts\/|youtu\.be\/|youtube\.com\/watch\?v=)([a-zA-Z0-9_-]{11})/);
      if (!match) return info.innerHTML = "<p style='color:#ff5555'>Link sai r·ªìi bro!</p>";

      const id = match[1];
      info.innerHTML = "<p id='loading'>ƒêang t·∫£i video + ti·∫øng‚Ä¶ (4‚Äì7 gi√¢y)</p>";

      try {
        // Proxy b·ªÅn nh·∫•t: allorigins.win (CORS free, h·ªó tr·ª£ YouTube API 2025)
        const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(`https://pipedapi.kavin.rocks/streams/${id}`)}`;
        const res = await fetch(proxyUrl);
        if (!res.ok) throw "Proxy lag";
        const proxyData = await res.json();
        const data = JSON.parse(proxyData.contents);

        info.innerHTML = `
          <h2>${data.title}</h2>
          <p>${data.uploader} ‚Ä¢ ${data.uploadDate} ‚Ä¢ ${Number(data.views || 0).toLocaleString()} l∆∞·ª£t xem</p>
          <img src="${data.thumbnail}" alt="Thumbnail">
        `;

        // HLS stream qua proxy (c√≥ ti·∫øng t·ª± ƒë·ªông)
        const hlsStreams = data.hlsStreams || [];
        const bestHls = hlsStreams.find(s => s.quality === '1080p') || hlsStreams.find(s => s.quality === '720p') || hlsStreams[0];
        if (bestHls) {
          // Proxy HLS URL ƒë·ªÉ tr√°nh CORS khi ph√°t
          const hlsProxy = `https://api.allorigins.win/get?url=${encodeURIComponent(bestHls.url)}`;
          video.src = hlsProxy;  // Browser s·∫Ω fetch proxy r·ªìi stream
        } else {
          throw "Kh√¥ng c√≥ HLS";
        }
        video.load();

      } catch (e) {
        console.log("Proxy fail, fallback...");
        // Fallback: M·ªü proxy web (YouTubeUnblocked ‚Äì c√≥ ti·∫øng, kh√¥ng ads, kh√¥ng CORS)
        const fallbackUrl = `https://www.youtubeunblocked.live/watch?v=${id}`;
        info.innerHTML = `
          <p style='color:yellow'>Proxy lag, m·ªü tab m·ªõi xem nh√©!</p>
          <a href="${fallbackUrl}" target="_blank" class="fallback">üîó Xem video c√≥ ti·∫øng ·ªü ƒë√¢y (kh√¥ng qu·∫£ng c√°o)</a>
        `;
        video.src = '';  // T·∫Øt video tag
      }
    });
  </script>
</body>
</html>
